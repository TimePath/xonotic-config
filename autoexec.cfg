// TimePath

exec reset.cfg

minplayers 4

// Player

cl_allow_uid2name "1"
_cl_name "TimePath"
_cl_color "222"
_cl_playermodel "models/player/megaerebus.iqm"
cl_forceplayermodels "1"

// Binds

bind TAB "+userbind 19"
bind ENTER "messagemode"
bind ESCAPE "togglemenu"
bind SPACE "+jump"
bind 0 "// not bound"
bind 1 "// not bound"
bind 5 "// not bound"
bind 6 "// not bound"
bind 7 "// not bound"
bind 8 "// not bound"
bind 9 "// not bound"
bind BACKSLASH "messagemode2"
bind BACKQUOTE "toggleconsole"
bind a "+moveleft"
bind d "+moveright"
bind f "+use"
bind g "dropweapon"
bind i "+show_info"
bind m "+hud_panel_radar_maximized"
bind p "// not bound"
bind s "+back"
bind t "// not bound"
bind u "// not bound"
bind v "+button8"
bind w "+forward"
bind y "// not bound"
bind z "// not bound"
bind TILDE "// not bound"

bind BACKSPACE "+con_chat_maximize"

bind UPARROW "// not bound"
bind DOWNARROW "// not bound"
bind LEFTARROW "// not bound"
bind RIGHTARROW "// not bound"
bind ALT "// not bound"

bind SHIFT "+crouch"

bind F1 "vyes"
bind F2 "vno"
bind F3 "spec"
bind F4 "ready"
bind F5 "menu_showteamselect"
bind F6 "team_auto"
bind F7 "menu_showsandboxtools"
bind F10 "disconnect"
bind F11 "+userbind 21"
bind F12 "screenshot"

bind PAUSE "pause"

bind KP_INS "// not bound"
bind KP_END "+userbind 1"
bind KP_DOWNARROW "+userbind 2"
bind KP_PGDN "+userbind 3"
bind KP_LEFTARROW "+userbind 4"
bind KP_5 "+userbind 6"
bind KP_RIGHTARROW "+userbind 7"
bind KP_HOME "+userbind 9"
bind KP_UPARROW "+userbind 10"
bind KP_PGUP "+userbind 11"
bind KP_DEL "// not bound"
bind KP_SLASH "+userbind 13"
bind KP_MULTIPLY "+userbind 12"
bind KP_MINUS "+userbind 18"
bind KP_PLUS "+userbind 17"
bind KP_ENTER "+userbind 16"

// http://forums.xonotic.org/showthread.php?tid=2987


// Conditionals
// Principles:
// Commands are chained because aliases are expanded before entering them
// Toggle makes all nonzero values become zero

alias if "_if[*] ${1}; toggle _if[*]; alias _if[0] ${2-}; _if.2"
alias _if.2 "_if[${_if[*]}]"
set _if[*] "" // variable value to check
alias _if[1] // noop to reduce console spam


// Arithmetic
// load is used to avoid name clashes with rpn commands

alias ++ "rpn /${1} dup load 1 + ="
alias -- "rpn /${1} dup load 1 - ="


// Hash-based String Comparison
// Principle: if the hashes collide, the same variable will be overwritten

alias strcmp "rpn /_arg[1] \"/${1}\" /SHA256 digest =; rpn /_arg[2] \"/${2}\" /SHA256 digest =; _strcmp.2"
alias _strcmp.2 "set _strcmp[${_arg[1]}] 0; set _strcmp[${_arg[2]}] 1; set _strcmp_true \"_strcmp[${_arg[1]}]\"; _strcmp.3"
alias _strcmp.3 "set _strcmp_true ${$_strcmp_true}; set _strcmp[${_arg[1]}] 0; set _strcmp_false \"_strcmp[${_arg[2]}]\";  _strcmp.4"
alias _strcmp.4 "set _strcmp_false ${$_strcmp_false}"

alias if_strcmp "strcmp ${1} ${2}; alias _arg[3] ${3- q}; if_strcmp.2"
alias if_strcmp.2 "if ${_strcmp_true} _arg[3]"

alias if_not_strcmp "strcmp ${1} ${2}; alias _arg[3] ${3- q}; if_not_strcmp.2"
alias if_not_strcmp.2 "if ${_strcmp_false} _arg[3]"


// Weapon checks

alias if_weapon "if_strcmp ${_weapon} ${1} ${2-}"
alias if_not_weapon "if_not_strcmp ${_weapon} ${1} ${2-}"
set _weapon "none"
alias cl_hook_activeweapon "echo $1; _weapon ${1}; x_on_weapon_change"


// Weapon hooks

alias x_on_weapon_change "weaponstack.push ${_weapon}; equipped_other; if_weapon laser equipped_laser; if_weapon hook equipped_hook; if_weapon minstanex equipped_minst"

// Weaplast without laser

set weaponstack ""
alias weaponstack.push "rpn /_weaponstack[*] /${1} weaponstack union /shotgun union \"/laser none\" difference =; _weaponstack.push.2"
alias _weaponstack.push.2 "_weaponstack.push.3 ${_weaponstack[*]}"
alias _weaponstack.push.3 "weaponstack \"${1 ?} ${2 ?}\"""

alias weaplast-laser "x_switch_weapon2 ${weaponstack} shotgun shotgun"
alias x_switch_weapon2 "weapon_${2}"

// Custom stuff

set x_laser_state 0
alias +x_laser_other "x_laser_state 1; weapon_laser"
alias +x_laser_laser "x_laser_state 1; +fire"
alias +x_laser_minst "x_laser_state 1; +fire2"
alias -x_laser "x_laser_state 0; -fire; -fire2"

set x_attack_state 0
alias +x_attack_laser "x_attack_state 1; weaplast" // TODO: -laser causes problems on respawn
alias +x_attack_hook "x_attack_state 1; weaplast"
alias +x_attack_normal "x_attack_state 1; +fire"
alias -x_attack "x_attack_state 0; -fire"

alias +x_attack2_other "+fire2"
alias +x_attack2_minst "+zoom"
alias -x_attack2 "-fire2; -zoom"

alias equipped_other "alias +x_attack2 +x_attack2_other; alias +x_laser +x_laser_other; alias +x_attack +x_attack_normal; if ${x_attack_state} +fire"
alias equipped_laser "alias +x_laser +x_laser_laser; alias +x_attack +x_attack_laser; if ${x_laser_state} +fire"
alias equipped_hook "alias +x_laser +x_laser_other; alias +x_attack +x_attack_laser"
alias equipped_minst "alias +x_attack2 +x_attack2_minst; alias +x_laser +x_laser_minst"


alias +x_hook ""

bind MOUSE1 "+x_laser"
bind MOUSE2 "+x_attack"
bind MOUSE3 "weapon_group_2"
bind MWHEELDOWN "weapon_group_3"
bind MWHEELUP "weapon_group_4"
bind e "weapon_group_5"
bind r "weapon_group_6"
bind q "weapon_group_7"
bind c "weapon_group_8"
bind v "weapon_group_9"
bind b "weapon_porto"

bind MOUSE6 "+x_attack2" // MOUSE4
bind MOUSE7 "+hook" // MOUSE5

// Gameplay

	sensitivity "6"
	m_accelerate "0"
	
	vid_vsync "0"

	cl_reticle "0"
	cl_velocityzoom "0"
	cl_zoomfactor "5"

	fov "110"
	
	cl_autoswitch "0"

	cl_gunalign "1" // Center gun

	crosshair "20" // 27, 16, 20
	crosshair_alpha "0.75"
	crosshair_dot "1"
	crosshair_dot_color "1 1 1"

	crosshair_pickup "0" // No visual pickup indication

	crosshair_hitindication "0.1"

	// Disable hit testing
	crosshair_hittest "1" // 1.25
	crosshair_hittest_blur "0"
	crosshair_hittest_showimpact "0"

	crosshair_ring_inner "1"
	crosshair_ring_reload_size "2"

	crosshair_size "0.3"
	crosshair_dot_size "1.25"

	crosshair_minstanex_size "0.8"

	cl_bob "0"
	cl_bob2 "0
	cl_bobmodel "0"
	cl_bobup "0"
	cl_bobfall "0"
	cl_smoothviewheight "0"
	cl_leanmodel "0"
	cl_followmodel "0"

	// Accuracy

	scoreboard_accuracy "1"
	accuracy_color1 "0 1 0"
	accuracy_color2 "0 0 1"
	accuracy_color_levels "0 50 100"

// Video
	
	// exec "effects-omg.cfg" // omg, low, med, normal, high, ultra, ultimate
	
	// omg
	
	cl_decals 0
	cl_decals_models 0
	cl_decals_time 2
	cl_particles_quality 0.4
	cl_damageeffect 0
	cl_spawn_point_particles 0
	cl_playerdetailreduction 4
	gl_flashblend 1
	gl_picmip 1337
	mod_q3bsp_nolightmaps 1
	r_bloom 0
	r_coronas 1
	r_coronas_occlusionquery 0
	hud_postprocessing_maxbluralpha 0
	hud_powerup 0
	r_depthfirst 0
	r_drawdecals_drawdistance 100
	r_drawparticles_drawdistance 250
	r_glsl_deluxemapping 0
	r_glsl_offsetmapping 0
	r_glsl_offsetmapping_reliefmapping 0
	r_motionblur 0
	r_shadow_gloss 0
	r_shadow_realtime_dlight 0
	r_shadow_realtime_dlight_shadows 0
	r_shadow_realtime_world 0
	r_shadow_realtime_world_shadows 0
	r_shadow_shadowmapping 0
	r_shadow_usenormalmap 0
	r_showsurfaces 3
	r_subdivisions_tolerance 16
	r_texture_dds_load 1
	
	// low
	
// 	cl_decals 1
// 	cl_playerdetailreduction 2
// 	gl_picmip 1
// 	r_drawdecals_drawdistance 200
// 	r_drawparticles_drawdistance 500
	r_showsurfaces 0 // 3 = single color
// 	r_subdivisions_tolerance 8
	
	// cel shading outline
	
// 	r_shadow_deferred "1"
// 	r_celoutlines "1"
// 	r_celshading "0"
	
	// Shadows - nice
	
// 	r_shadows "1"
// 	r_shadow_shadowmapping "0"
	
	// Shadows - off
	
// 	r_shadows "0"
// 	r_shadow_shadowmapping "0"
	
	// Simplicity
	
	cl_casings "0"
	cl_simple_items "1"
	r_ambient "32"
// 	r_drawparticles "0"

// 	gl_picmip "3"
// 	gl_picmip_world "10"
	//gl_picmip_other "1" // players
	
	// Water - low
	
	r_water 0
	r_water_resolutionmultiplier 0.25
	
	// Water - good portals

	r_water "1"
	r_water_resolutionmultiplier "1"
	
// 	r_water_hideplayer "2"
// 	r_water_reflectdistort "0"
// 	r_water_refractdistort "0"
// 	r_waterwarp "0"
//	r_water_lowquality "2"

// Audio

	mastervolume "0.100000"
	snd_channel6volume "1" // TODO: disable in minsta

	snd_mutewhenidle "0"
	snd_spatialization_control "1"
	menu_snd_attenuation_method "0"

// HUD

	// Frag messages

	hud_panel_centerprint "1"
	hud_panel_centerprint_fontscale "1"
	hud_panel_timer_increment "0"

// Perf

	cl_maxfps_alwayssleep "0"
	cl_maxidlefps "20"
	cl_minfps "1000"
	cl_maxfps "0"

	gl_vbo "1" // can be buggy

	gl_texturecompression "1"

	mod_q3bsp_nolightmaps "1"

// UNCATEGORISED

	cl_curl_maxdownloads "5"
	cl_curl_maxspeed "1000"

	menu_tooltips "2"
	showfps "1"
	showtime "0"
	showdate "0"

	cl_clippedspectating "0"

	cl_joinbeforedownloadsfinish "0"

	cl_autodemo "1"
	cl_autoscreenshot "1"

	con_chat "10"

	cl_deathglow "0.8"

	seta "hud_damage" "0.5"
	seta "hud_damage_factor" "0.025"
	seta "hud_damage_fade_rate" "0.75"
	seta "hud_panel_physics" "2"
	seta "hud_panel_physics_speed_unit" "1"
	seta "hud_panel_radar_zoommode" "3"

// menu_sync

// Resolution

vid_width "1920"
vid_conwidth "960"
vid_height "1080"
vid_conheight "540"

vid_fullscreen "1"
vid_resizable "1"
